> **AI 模型 → API → Docker → Cloud 部署**

我們假設你想做一個簡單的「影像分類」AI 模型，並讓全世界都能呼叫你的服務。

---

# 🚀 Windows 實作步驟全攻略

---

## ✅ Step 1 — AI 模型

---

### 做什麼？

- 訓練一個 AI 模型
- 存成檔案（例如 .pkl）

---

### 在 Windows 怎麼做？

#### ① 建立專案資料夾

在 Windows cmd：

```cmd
D:
cd D:\
mkdir AI_Side_Project
cd AI_Side_Project
```

---

#### ② 建立 venv

先安裝 Python（若尚未安裝）

建立 virtual environment：

```cmd
python -m venv venv
```

啟動 venv：

```cmd
venv\Scripts\activate
```

你會看到：

```
(venv) D:\AI_Side_Project>
```

✅ 表示進入 venv

---

#### ③ 安裝必要套件

在 venv 環境執行：

```cmd
pip install scikit-learn numpy fastapi uvicorn
```

---

#### ④ 建立 Python 檔

在 VS Code 或 Windows 檔案總管新增：

```
main.py
```

---

#### ⑤ 寫 AI 模型

在 `main.py` 寫：

```python
from sklearn import datasets
from sklearn.ensemble import RandomForestClassifier
import pickle

# 載入範例影像資料
digits = datasets.load_digits()
X, y = digits.data, digits.target

# 建模
model = RandomForestClassifier()
model.fit(X, y)

# 存模型
with open("model.pkl", "wb") as f:
    pickle.dump(model, f)

print("模型已存檔！")
```

執行：

```cmd
python main.py
```

會產生：

```
model.pkl
```

✅ 這就是你的 AI 模型。

---

## ✅ Step 2 — API

---

### 做什麼？

- 寫 API → 讓外界能送資料來預測

---

### 在 Windows 怎麼做？

---

#### ① 新增 FastAPI 程式

繼續在 `main.py` 後面加：

```python
from fastapi import FastAPI
from pydantic import BaseModel
import numpy as np

# 定義輸入格式
class Item(BaseModel):
    data: list

# 建立 FastAPI app
app = FastAPI()

# 載入 model
with open("model.pkl", "rb") as f:
    model = pickle.load(f)

@app.get("/")
def read_root():
    return {"message": "Hello from FastAPI!"}

@app.post("/predict")
def predict(item: Item):
    x = np.array(item.data).reshape(1, -1)
    y_pred = model.predict(x)
    return {"prediction": int(y_pred[0])}
```

---

#### ② 啟動 FastAPI

在 cmd：

```cmd
uvicorn main:app --reload
```

✅ 螢幕會出現：

```
INFO:     Uvicorn running on http://127.0.0.1:8000
```

打開瀏覽器：

```
http://127.0.0.1:8000/
```

看到：

```json
{ "message": "Hello from FastAPI!" }
```

進 Swagger UI：

```
http://127.0.0.1:8000/docs
```

---

#### ③ 測試 POST

用 Postman 或 cmd 測試：

cmd：

```cmd
curl -X POST http://127.0.0.1:8000/predict -H "Content-Type: application/json" -d "{\"data\": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]}"
```

或用 Postman 送：

```
POST http://127.0.0.1:8000/predict
{
    "data": [0, 0, 0, 0, ...]
}
```

✅ 就能拿到：

```json
{ "prediction": 7 }
```

---

## ✅ Step 3 — Docker

---

### 做什麼？

- 把整個專案打包 → 保證環境一致

---

### 在 Windows 怎麼做？

#### ① 安裝 Docker Desktop

先去：
[https://www.docker.com/products/docker-desktop/](https://www.docker.com/products/docker-desktop/)

→ 安裝完成 → 開啟 Docker Desktop

---

#### ② 建立 requirements.txt

在 `D:\AI_Side_Project` 建立：

```
requirements.txt
```

內容：

```
fastapi
uvicorn
scikit-learn
numpy
```

---

#### ③ 建立 Dockerfile

建立 `Dockerfile`：

```dockerfile
# 用 Python 官方 Image
FROM python:3.10

WORKDIR /app

COPY requirements.txt .

RUN pip install --no-cache-dir -r requirements.txt

COPY . .

CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8080"]
```

---

#### ④ Build Docker image

打：

```cmd
docker build -t my-ml-api .
```

---

#### ⑤ Run container

```cmd
docker run -d -p 8080:8080 my-ml-api
```

打開：

```
http://localhost:8080/
```

就看到：

```json
{ "message": "Hello from FastAPI!" }
```

---

## ✅ Step 4 — Cloud 部署

---

### 做什麼？

- 把 Docker image 放到雲端
- 全世界都能存取 API

---

### 在 Windows 怎麼做？

以 **GCP Cloud Run** 為例：

---

#### ① 安裝 GCP CLI

下載：
[https://cloud.google.com/sdk/docs/install-sdk](https://cloud.google.com/sdk/docs/install-sdk)

安裝完：

```cmd
gcloud init
```

---

#### ② Tag Docker image

```cmd
docker tag my-ml-api gcr.io/your-project-id/my-ml-api
```

---

#### ③ Push image

```cmd
docker push gcr.io/your-project-id/my-ml-api
```

---

#### ④ Deploy to Cloud Run

```cmd
gcloud run deploy my-ml-api ^
  --image gcr.io/your-project-id/my-ml-api ^
  --platform managed ^
  --region asia-east1 ^
  --allow-unauthenticated
```

部署完會拿到網址：

```
https://my-ml-api-xxxxx.a.run.app
```

全世界都能呼叫你的 AI API！

---

# ✅ 最終成果

✅ 你成功做出：

- 一個 AI 模型
- 做成 API
- 打包成 Docker
- 上雲端

任何人都能：

```
POST https://my-ml-api-xxxxx.a.run.app/predict
```

→ 拿到你的預測結果。

---

# ✅ 專案結構最終長這樣

```
D:\AI_Side_Project\
    venv\
    model.pkl
    main.py
    requirements.txt
    Dockerfile
```

---

**一句話結論：**

> 在 Windows 筆電，要完成「AI 模型 → API → Docker → Cloud 部署」就是：
>
> - 存模型
> - 寫 FastAPI
> - Docker 化
> - Deploy 到 Cloud Run

---

想不想我直接幫你產生範例 code？還是先做到哪一步？例如先做到 Docker？
